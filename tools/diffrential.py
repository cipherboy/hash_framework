import hash_framework.algorithms._md4 as m

import cmsh
from cmsh.array import l_xor

datas = [
    (
        (
            [2787629912, 166624029, 2173013050, 3228120650],
            [
                3832065070,
                893546744,
                1503935559,
                3886004964,
                376807297,
                3095397902,
                2796181248,
                3999295543,
                323295553,
                1610735870,
                2587804664,
                4228497797,
                178758430,
                2483281279,
                2820549323,
                3686939348,
            ],
        ),
        (
            [2787629912, 166624029, 2173013050, 3228120650],
            [
                3832065070,
                3041030392,
                3382983751,
                3886004964,
                376807297,
                3095397902,
                2796181248,
                3999295543,
                323295553,
                1610735870,
                2587804664,
                4228497797,
                178692894,
                2483281279,
                2820549323,
                3686939348,
            ],
        ),
    ),
    (
        (
            [653455935, 1565260673, 3137556433, 4202621184],
            [
                2038427517,
                1123791086,
                215937401,
                2386431847,
                3318571745,
                831650557,
                2161014768,
                147835980,
                3578493883,
                2041825069,
                2090718892,
                2302132736,
                3631922409,
                138719306,
                2977038875,
                2257501855,
            ],
        ),
        (
            [653455935, 1565260673, 3137556433, 4202621184],
            [
                2038427517,
                3271274734,
                2631856505,
                2386431847,
                3318571745,
                831650557,
                2161014768,
                147835980,
                3578493883,
                2041825069,
                2090718892,
                2302132736,
                3631987945,
                138719306,
                2977038875,
                2257501855,
            ],
        ),
    ),
]
datas = [
    (
        (
            [
                2049,
                2050,
                2051,
                2052,
                2053,
                2054,
                2055,
                2056,
                2057,
                2058,
                2059,
                2060,
                2061,
                2062,
                2063,
                2064,
                2065,
                2066,
                2067,
                2068,
                2069,
                2070,
                2071,
                2072,
                2073,
                2074,
                2075,
                2076,
                2077,
                2078,
                2079,
                2080,
                2081,
                2082,
                2083,
                2084,
                2085,
                2086,
                2087,
                2088,
                2089,
                2090,
                2091,
                2092,
                2093,
                2094,
                2095,
                2096,
                2097,
                2098,
                2099,
                2100,
                2101,
                2102,
                2103,
                2104,
                2105,
                2106,
                2107,
                2108,
                2109,
                2110,
                2111,
                2112,
                2113,
                2114,
                2115,
                2116,
                2117,
                2118,
                2119,
                2120,
                2121,
                2122,
                2123,
                2124,
                2125,
                2126,
                2127,
                2128,
                2129,
                2130,
                2131,
                2132,
                2133,
                2134,
                2135,
                2136,
                2137,
                2138,
                2139,
                2140,
                2141,
                2142,
                2143,
                2144,
                2145,
                2146,
                2147,
                2148,
                2149,
                2150,
                2151,
                2152,
                2153,
                2154,
                2155,
                2156,
                2157,
                2158,
                2159,
                2160,
                2161,
                2162,
                2163,
                2164,
                2165,
                2166,
                2167,
                2168,
                2169,
                2170,
                2171,
                2172,
                2173,
                2174,
                2175,
                2176,
            ],
            [
                3218739102,
                1750456403,
                2992357659,
                3577738143,
                1160509119,
                1335490943,
                1430112183,
                550518395,
                2501383743,
                4155270006,
                3170447087,
                2398624563,
                3768671822,
                2429781255,
                3325601353,
                1790185907,
            ],
        ),
        (
            [
                2177,
                2178,
                2179,
                2180,
                2181,
                2182,
                2183,
                2184,
                2185,
                2186,
                2187,
                2188,
                2189,
                2190,
                2191,
                2192,
                2193,
                2194,
                2195,
                2196,
                2197,
                2198,
                2199,
                2200,
                2201,
                2202,
                2203,
                2204,
                2205,
                2206,
                2207,
                2208,
                2209,
                2210,
                2211,
                2212,
                2213,
                2214,
                2215,
                2216,
                2217,
                2218,
                2219,
                2220,
                2221,
                2222,
                2223,
                2224,
                2225,
                2226,
                2227,
                2228,
                2229,
                2230,
                2231,
                2232,
                2233,
                2234,
                2235,
                2236,
                2237,
                2238,
                2239,
                2240,
                2241,
                2242,
                2243,
                2244,
                2245,
                2246,
                2247,
                2248,
                2249,
                2250,
                2251,
                2252,
                2253,
                2254,
                2255,
                2256,
                2257,
                2258,
                2259,
                2260,
                2261,
                2262,
                2263,
                2264,
                2265,
                2266,
                2267,
                2268,
                2269,
                2270,
                2271,
                2272,
                2273,
                2274,
                2275,
                2276,
                2277,
                2278,
                2279,
                2280,
                2281,
                2282,
                2283,
                2284,
                2285,
                2286,
                2287,
                2288,
                2289,
                2290,
                2291,
                2292,
                2293,
                2294,
                2295,
                2296,
                2297,
                2298,
                2299,
                2300,
                2301,
                2302,
                2303,
                2304,
            ],
            [
                3218739102,
                3897940051,
                576438555,
                3577738143,
                1160509119,
                1335490943,
                1430112183,
                550518395,
                2501383743,
                4155270006,
                3170447087,
                2398624563,
                3768606286,
                2429781255,
                3325601353,
                1790185907,
            ],
        ),
    ),
    (
        (
            [
                2049,
                2050,
                2051,
                2052,
                2053,
                2054,
                2055,
                2056,
                2057,
                2058,
                2059,
                2060,
                2061,
                2062,
                2063,
                2064,
                2065,
                2066,
                2067,
                2068,
                2069,
                2070,
                2071,
                2072,
                2073,
                2074,
                2075,
                2076,
                2077,
                2078,
                2079,
                2080,
                2081,
                2082,
                2083,
                2084,
                2085,
                2086,
                2087,
                2088,
                2089,
                2090,
                2091,
                2092,
                2093,
                2094,
                2095,
                2096,
                2097,
                2098,
                2099,
                2100,
                2101,
                2102,
                2103,
                2104,
                2105,
                2106,
                2107,
                2108,
                2109,
                2110,
                2111,
                2112,
                2113,
                2114,
                2115,
                2116,
                2117,
                2118,
                2119,
                2120,
                2121,
                2122,
                2123,
                2124,
                2125,
                2126,
                2127,
                2128,
                2129,
                2130,
                2131,
                2132,
                2133,
                2134,
                2135,
                2136,
                2137,
                2138,
                2139,
                2140,
                2141,
                2142,
                2143,
                2144,
                2145,
                2146,
                2147,
                2148,
                2149,
                2150,
                2151,
                2152,
                2153,
                2154,
                2155,
                2156,
                2157,
                2158,
                2159,
                2160,
                2161,
                2162,
                2163,
                2164,
                2165,
                2166,
                2167,
                2168,
                2169,
                2170,
                2171,
                2172,
                2173,
                2174,
                2175,
                2176,
            ],
            [
                2098634684,
                119603339,
                2241059475,
                1577247613,
                2691800285,
                671680034,
                767456040,
                2130085450,
                2985999488,
                4175961982,
                1563365022,
                972668567,
                198213978,
                219117410,
                71572271,
                3858949791,
            ],
        ),
        (
            [
                2177,
                2178,
                2179,
                2180,
                2181,
                2182,
                2183,
                2184,
                2185,
                2186,
                2187,
                2188,
                2189,
                2190,
                2191,
                2192,
                2193,
                2194,
                2195,
                2196,
                2197,
                2198,
                2199,
                2200,
                2201,
                2202,
                2203,
                2204,
                2205,
                2206,
                2207,
                2208,
                2209,
                2210,
                2211,
                2212,
                2213,
                2214,
                2215,
                2216,
                2217,
                2218,
                2219,
                2220,
                2221,
                2222,
                2223,
                2224,
                2225,
                2226,
                2227,
                2228,
                2229,
                2230,
                2231,
                2232,
                2233,
                2234,
                2235,
                2236,
                2237,
                2238,
                2239,
                2240,
                2241,
                2242,
                2243,
                2244,
                2245,
                2246,
                2247,
                2248,
                2249,
                2250,
                2251,
                2252,
                2253,
                2254,
                2255,
                2256,
                2257,
                2258,
                2259,
                2260,
                2261,
                2262,
                2263,
                2264,
                2265,
                2266,
                2267,
                2268,
                2269,
                2270,
                2271,
                2272,
                2273,
                2274,
                2275,
                2276,
                2277,
                2278,
                2279,
                2280,
                2281,
                2282,
                2283,
                2284,
                2285,
                2286,
                2287,
                2288,
                2289,
                2290,
                2291,
                2292,
                2293,
                2294,
                2295,
                2296,
                2297,
                2298,
                2299,
                2300,
                2301,
                2302,
                2303,
                2304,
            ],
            [
                2098634684,
                2267086987,
                362011283,
                1577247613,
                2691800285,
                671680034,
                767456040,
                2130085450,
                2985999488,
                4175961982,
                1563365022,
                972668567,
                198279514,
                219117410,
                71572271,
                3858949791,
            ],
        ),
    ),
]
data = [
    (
        (
            [
                2049,
                2050,
                2051,
                2052,
                2053,
                2054,
                2055,
                2056,
                2057,
                2058,
                2059,
                2060,
                2061,
                2062,
                2063,
                2064,
                2065,
                2066,
                2067,
                2068,
                2069,
                2070,
                2071,
                2072,
                2073,
                2074,
                2075,
                2076,
                2077,
                2078,
                2079,
                2080,
                2081,
                2082,
                2083,
                2084,
                2085,
                2086,
                2087,
                2088,
                2089,
                2090,
                2091,
                2092,
                2093,
                2094,
                2095,
                2096,
                2097,
                2098,
                2099,
                2100,
                2101,
                2102,
                2103,
                2104,
                2105,
                2106,
                2107,
                2108,
                2109,
                2110,
                2111,
                2112,
                2113,
                2114,
                2115,
                2116,
                2117,
                2118,
                2119,
                2120,
                2121,
                2122,
                2123,
                2124,
                2125,
                2126,
                2127,
                2128,
                2129,
                2130,
                2131,
                2132,
                2133,
                2134,
                2135,
                2136,
                2137,
                2138,
                2139,
                2140,
                2141,
                2142,
                2143,
                2144,
                2145,
                2146,
                2147,
                2148,
                2149,
                2150,
                2151,
                2152,
                2153,
                2154,
                2155,
                2156,
                2157,
                2158,
                2159,
                2160,
                2161,
                2162,
                2163,
                2164,
                2165,
                2166,
                2167,
                2168,
                2169,
                2170,
                2171,
                2172,
                2173,
                2174,
                2175,
                2176,
            ],
            [
                3218739102,
                1750456403,
                2992357659,
                3577738143,
                1160509119,
                1335490943,
                1430112183,
                550518395,
                2501383743,
                4155270006,
                3170447087,
                2398624563,
                3768671822,
                2429781255,
                3325601353,
                1790185907,
            ],
        ),
        (
            [
                2177,
                2178,
                2179,
                2180,
                2181,
                2182,
                2183,
                2184,
                2185,
                2186,
                2187,
                2188,
                2189,
                2190,
                2191,
                2192,
                2193,
                2194,
                2195,
                2196,
                2197,
                2198,
                2199,
                2200,
                2201,
                2202,
                2203,
                2204,
                2205,
                2206,
                2207,
                2208,
                2209,
                2210,
                2211,
                2212,
                2213,
                2214,
                2215,
                2216,
                2217,
                2218,
                2219,
                2220,
                2221,
                2222,
                2223,
                2224,
                2225,
                2226,
                2227,
                2228,
                2229,
                2230,
                2231,
                2232,
                2233,
                2234,
                2235,
                2236,
                2237,
                2238,
                2239,
                2240,
                2241,
                2242,
                2243,
                2244,
                2245,
                2246,
                2247,
                2248,
                2249,
                2250,
                2251,
                2252,
                2253,
                2254,
                2255,
                2256,
                2257,
                2258,
                2259,
                2260,
                2261,
                2262,
                2263,
                2264,
                2265,
                2266,
                2267,
                2268,
                2269,
                2270,
                2271,
                2272,
                2273,
                2274,
                2275,
                2276,
                2277,
                2278,
                2279,
                2280,
                2281,
                2282,
                2283,
                2284,
                2285,
                2286,
                2287,
                2288,
                2289,
                2290,
                2291,
                2292,
                2293,
                2294,
                2295,
                2296,
                2297,
                2298,
                2299,
                2300,
                2301,
                2302,
                2303,
                2304,
            ],
            [
                3218739102,
                3897940051,
                576438555,
                3577738143,
                1160509119,
                1335490943,
                1430112183,
                550518395,
                2501383743,
                4155270006,
                3170447087,
                2398624563,
                3768606286,
                2429781255,
                3325601353,
                1790185907,
            ],
        ),
    ),
    (
        (
            [
                2049,
                2050,
                2051,
                2052,
                2053,
                2054,
                2055,
                2056,
                2057,
                2058,
                2059,
                2060,
                2061,
                2062,
                2063,
                2064,
                2065,
                2066,
                2067,
                2068,
                2069,
                2070,
                2071,
                2072,
                2073,
                2074,
                2075,
                2076,
                2077,
                2078,
                2079,
                2080,
                2081,
                2082,
                2083,
                2084,
                2085,
                2086,
                2087,
                2088,
                2089,
                2090,
                2091,
                2092,
                2093,
                2094,
                2095,
                2096,
                2097,
                2098,
                2099,
                2100,
                2101,
                2102,
                2103,
                2104,
                2105,
                2106,
                2107,
                2108,
                2109,
                2110,
                2111,
                2112,
                2113,
                2114,
                2115,
                2116,
                2117,
                2118,
                2119,
                2120,
                2121,
                2122,
                2123,
                2124,
                2125,
                2126,
                2127,
                2128,
                2129,
                2130,
                2131,
                2132,
                2133,
                2134,
                2135,
                2136,
                2137,
                2138,
                2139,
                2140,
                2141,
                2142,
                2143,
                2144,
                2145,
                2146,
                2147,
                2148,
                2149,
                2150,
                2151,
                2152,
                2153,
                2154,
                2155,
                2156,
                2157,
                2158,
                2159,
                2160,
                2161,
                2162,
                2163,
                2164,
                2165,
                2166,
                2167,
                2168,
                2169,
                2170,
                2171,
                2172,
                2173,
                2174,
                2175,
                2176,
            ],
            [
                3894643848,
                216851074,
                2736728107,
                3720370612,
                976556240,
                650110993,
                1196478640,
                1089787200,
                3867432554,
                748697785,
                4236017266,
                1508326144,
                3407514366,
                2282618898,
                147835664,
                2499084792,
            ],
        ),
        (
            [
                2177,
                2178,
                2179,
                2180,
                2181,
                2182,
                2183,
                2184,
                2185,
                2186,
                2187,
                2188,
                2189,
                2190,
                2191,
                2192,
                2193,
                2194,
                2195,
                2196,
                2197,
                2198,
                2199,
                2200,
                2201,
                2202,
                2203,
                2204,
                2205,
                2206,
                2207,
                2208,
                2209,
                2210,
                2211,
                2212,
                2213,
                2214,
                2215,
                2216,
                2217,
                2218,
                2219,
                2220,
                2221,
                2222,
                2223,
                2224,
                2225,
                2226,
                2227,
                2228,
                2229,
                2230,
                2231,
                2232,
                2233,
                2234,
                2235,
                2236,
                2237,
                2238,
                2239,
                2240,
                2241,
                2242,
                2243,
                2244,
                2245,
                2246,
                2247,
                2248,
                2249,
                2250,
                2251,
                2252,
                2253,
                2254,
                2255,
                2256,
                2257,
                2258,
                2259,
                2260,
                2261,
                2262,
                2263,
                2264,
                2265,
                2266,
                2267,
                2268,
                2269,
                2270,
                2271,
                2272,
                2273,
                2274,
                2275,
                2276,
                2277,
                2278,
                2279,
                2280,
                2281,
                2282,
                2283,
                2284,
                2285,
                2286,
                2287,
                2288,
                2289,
                2290,
                2291,
                2292,
                2293,
                2294,
                2295,
                2296,
                2297,
                2298,
                2299,
                2300,
                2301,
                2302,
                2303,
                2304,
            ],
            [
                3894643848,
                2364334722,
                857679915,
                3720370612,
                976556240,
                650110993,
                1196478640,
                1089787200,
                3867432554,
                748697785,
                4236017266,
                1508326144,
                3407579902,
                2282618898,
                147835664,
                2499084792,
            ],
        ),
    ),
]
datas = [
    (
        (
            0,
            11624580360192542633524238814811444549424997892067651225478530092076575659964275267568726214523942123773967008015609302974427256070625380989473601649656434,
        ),
        (
            0,
            11624580361753416909091081712918522040255575686878952847384938932892770548685299374017718624147881507176695459622014774168251782780408921545261454048117362,
        ),
    ),
    (
        (
            0,
            11622686242377531278716813089405908511206770427409614156643224368942835996989813529160422627835717044768537344139168466114086657460713384743467450616418310,
        ),
        (
            0,
            11622686243938405553556817263217379111488024414332911244195991849071712825429347436428775749346258504845074745031810371747148662564230747365720701386264582,
        ),
    ),
]
datas = [
    (
        (
            0,
            12474916653442100900016338539618127959945293833754878529267814700403903555494253313779618383262396053499011767012251537589155321316917832652202575695874592,
        ),
        (
            0,
            12474916655002975175492326597188254589457206152580179584380018371134183686680091145331030881872160696485966337279436563077499939108848445709237610232318496,
        ),
    ),
    (
        (
            0,
            6543412544601654715867842988466250134585141164602775361536337903552611166735546069329541423535382664352178983074752164292885142999022380942708327742375294,
        ),
        (
            0,
            6543412546162528990707847162277720734866395151526072449089105383681487995175079976597894545045924124428716383967394069925947148102539743564961578512221566,
        ),
    ),
]
datas = [
    (
        (
            0,
            678358977106290281453681386836332003875426307756748785898799998684013735337139494684237969303205603230812181832692505079499599717924866570733844085758765,
        ),
        (
            0,
            678358978667164557020524284943409494706004102568050407805208839500208624058163601133230378927144986633540633439097976273324126427708407126521696484219693,
        ),
    ),
    (
        (
            0,
            904430949745810789401847921409247358821677260762328499165011157806368867438682295233058508004516080722744826038880228398797155098219574394343843530286891,
        ),
        (
            0,
            904430951306685064877835978979373988333589579587629554277214828536648998624520126784471006614280723709699396306065253887141772890150187451378878066730795,
        ),
    ),
    (
        (
            0,
            12400734608012191290457670467771404982735741097616872600035810108435447427611129782645781784717080007552354088975729716659421093424197592688847553118221154,
        ),
        (
            0,
            12400734609573065566024513365878482473566318892428174221942218949251642316332153889094774194341019390955082540582135187853245620133981133244635405516682082,
        ),
    ),
    (
        (
            0,
            10802243019326833714248788540654649026964450103855678845892268966695480875863972471490978732122415175154310648270927142513437067991504420334624812269925824,
        ),
        (
            0,
            10802243020887707989815631438761726517795027898666980467798677807511675764584996577939971141746354558557039099877332613707261594701287960890412664668386752,
        ),
    ),
    (
        (
            0,
            4327188753426313055045217158760710827347919806167611567845055302841209037467934527849548060837355667357261439806797933606573568051516571610522110097288444,
        ),
        (
            0,
            4327188754987187330521205216330837456859832124992912622957258973571489168653772359400960559447120310344216010073982959094918185843447184667557144633732348,
        ),
    ),
    (
        (
            0,
            12889851628999279668654298233231032870599909112862267796885025259885977740180909569479394024342680467971095537826752517645280582105585293101117184149002964,
        ),
        (
            0,
            12889851630560153944221141131338110361430486907673569418791434100702172628901933675928386433966619851373823989433157988839105108815368833656905036547463892,
        ),
    ),
    (
        (
            0,
            1124340464747283182681573965151248314026581909462346214854926879704796027078105661805044535435773551585791868465680711577237808548019633091915948331120727,
        ),
        (
            0,
            1124340466308157457521578138962718914307835896385643302407694359833672855517639569073397656946315011662329269358322617210299813651536995714169199100966999,
        ),
    ),
    (
        (
            0,
            10356875291790295782807037893815708446969105083147577185431901498138422188413334946987185038801474321753354200377721780654811099661111053991841509813505503,
        ),
        (
            0,
            10356875293351170058283025951385835076481017401972878240544105168868702319599172778538597537411238964740308770644906806143155717453041667048876544349949407,
        ),
    ),
    (
        (
            0,
            2625429997126882624665255525837406904380179757627963586955886200369656512065574355275560153223776438810183930420566480694684076454518484024293364218164525,
        ),
        (
            0,
            2625429998687756899505259699648877504661433744551260674508653680498533340505108262543913274734317898886721331313208386327746081558035846646546614988010797,
        ),
    ),
    (
        (
            0,
            7628497923547126769047331476522203395668850778399503929849012069547116228834756893893804704690501744895269416192057280562873791158481495382574084521122544,
        ),
        (
            0,
            7628497925108001043796480809796723134631439289336800450607574379590078299739104526264577915186868464556032935745478740490455887344145930506074517428951792,
        ),
    ),
]

model = cmsh.Model()

dps = []

for data in datas:
    left, right = data
    l_iv, l_bi = left
    r_iv, r_bi = right

    l_b = model.to_vec(l_bi, width=512)
    r_b = model.to_vec(r_bi, width=512)

    l_ba = model.split_vec(l_b, 32)
    r_ba = model.split_vec(r_b, 32)

    db = l_b ^ r_b

    l_r, l_rsa = m.md4(model, l_ba)
    r_r, r_rsa = m.md4(model, r_ba)

    l_rs = model.join_vec(l_rsa)
    r_rs = model.join_vec(r_rsa)
    dp = l_rs ^ r_rs

    lv = model.join_vec(l_r)
    rv = model.join_vec(r_r)

    assert int(lv) == int(rv)

    dps.append(int(dp))

print(len(dps))
for ii in range(0, len(dps)):
    grid = []
    for jj in range(0, len(dps)):
        i = dps[ii]
        j = dps[jj]
        xor = i ^ j
        bs = model.to_vec(xor).bit_sum()
        grid.append(int(bs))
    print(ii, grid)
