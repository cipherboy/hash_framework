import sqlite3, json
import hash_framework as hf
import png


def write_data():
    db = sqlite3.connect("/home/cipherboy/framework_results_2.db")
    curr = db.cursor()

    algo = hf.algorithms.md4()

    wangs_base = [
        "................................",
        ".........................*......",
        ".....................*..*.......",
        "......*.........................",
        "................................",
        "..................*.............",
        "..........****..................",
        ".................***............",
        "...............*................",
        "......*..****...................",
        "..*.............................",
        "*...............................",
        "......*..*......................",
        "..**.*..........................",
        "................................",
        ".............*..................",
        "*..*.**.........................",
        "................................",
        "................................",
        "*.*.............................",
        "*.**............................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "*...............................",
        "*...............................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
    ]
    sasakis_base = [
        "*.............................**",
        "......................*.*.......",
        "....................*...........",
        "..........***...................",
        ".......***............*******...",
        "*..........***..................",
        "*......***............*********.",
        "................................",
        "......*.**......................",
        "***.***............*............",
        "...................*............",
        "...................*............",
        "..**..*.........................",
        "................................",
        "................................",
        "*...............................",
        "...*............................",
        "................................",
        "................................",
        "................................",
        "*...............................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "*...............................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
    ]
    kasselman_base = [
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "********************************",
        "................................",
        "...*...............*............",
        "...................*...........*",
        "................................",
        "................................",
        "..........................*.....",
        "......*.........................",
        "................................",
        "................................",
        ".................*..............",
        ".........................*......",
        "................................",
        "................................",
        "........*.......................",
        "............*...................",
        "................................",
        "................................",
        "...............................*",
        "...............................*",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
    ]
    dobbertins_base = [
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "********************************",
        "................................",
        "...*...............*............",
        "...................*...........*",
        "................................",
        "................................",
        "..........................*.....",
        "......*.........................",
        "................................",
        "................................",
        ".................*..............",
        ".........................*......",
        "................................",
        "............*...................",
        "........*.......................",
        "............*...................",
        "................................",
        "................................",
        "...............................*",
        "...............................*",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
    ]
    schlaffers_base = [
        "................................",
        ".........................*......",
        ".....................*..*.......",
        "......*.........................",
        "................................",
        "...............****.............",
        "........***..*..................",
        "...................*.*..........",
        ".....**.....*...................",
        "........****....................",
        "..*.............................",
        "*.*............................*",
        "..**..*..*.**...................",
        "................................",
        "................................",
        "............**.*................",
        "*..*..*.........................",
        "................................",
        "................................",
        "*...............................",
        "*..*............................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "*...............................",
        "*...............................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
        "................................",
    ]

    bases = {
        "wangs": tuple(wangs_base),
        "sasakis": tuple(sasakis_base),
        "kasselmans": tuple(kasselman_base),
        "dobbertins": tuple(dobbertins_base),
        "schlaffers": tuple(schlaffers_base),
    }

    results = {}
    for k in bases:
        diff_path = bases[k]
        clauses = []
        for i in range(0, 48):
            clauses.append("ri" + str(i) + '="' + diff_path[i] + '"')

        q = "SELECT DISTINCT "
        q += ",".join(map(lambda x: "h1b" + str(x), range(16)))
        q += " FROM c_md4 WHERE "
        q += " AND ".join(clauses)
        q += ";"
        print(q)

        data = curr.execute(q).fetchall()
        print(len(data))

        max_value = max(map(lambda y: y.count("T"), map(lambda x: "".join(x), data)))
        results[k] = max_value

    print(results)


write_data()
